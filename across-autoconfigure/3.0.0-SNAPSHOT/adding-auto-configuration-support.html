<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Adding auto-configuration support - Across</title>
    <meta name="generator" content="Antora 2.1.1">
    <link rel="stylesheet" href="../../_/css/site.css">
<link href="https://fonts.googleapis.com/css?family=Open+Sans:300,400,600,700,800" rel="stylesheet">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/docsearch.js@2/dist/cdn/docsearch.min.css" />
<script type="text/javascript" src="https://cdn.jsdelivr.net/npm/docsearch.js@2/dist/cdn/docsearch.min.js"></script>
<meta name="og:title" content="Across Documentation"/>
<meta name="og:image" content="https://across.foreach.be/across/resources/static/acrossWebsite/img/og-image-across.jpg"/>
<link rel="icon" type="image/png" sizes="16x16" href="https://across.foreach.be/across/resources/static/acrossWebsite/img/favicon/favicon-16x16.png"/>
<link rel="icon" type="image/png" sizes="32x32" href="https://across.foreach.be/across/resources/static/acrossWebsite/img/favicon/favicon-32x32.png"/>
<link rel="icon" type="image/png" sizes="96x96" href="https://across.foreach.be/across/resources/static/acrossWebsite/img/favicon/favicon-96x96.png"/>
<link rel="apple-touch-icon" type="image/png" href="https://across.foreach.be/across/resources/static/acrossWebsite/img/favicon/apple-icon-120x120.png"/>
<link rel="apple-touch-icon" type="image/png" sizes="152x152" href="https://across.foreach.be/across/resources/static/acrossWebsite/img/favicon/apple-icon-152x152.png"/>
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="https://across.foreach.be/across/resources/static/acrossWebsite/img/favicon/apple-icon-180x180.png"/>
  </head>
  <body class="article">
<header class="header" role="banner">
  <div class="m-mobile-menu__button js-overlay-menu-button" data-target="mobile-menu">
    <span class="m-mobile-menu__line"></span>
    <span class="m-mobile-menu__line"></span>
    <span class="m-mobile-menu__line"></span>
  </div>

  <div class="m-mobile-menu">
    <div class="m-mobile-menu__logo">
      <a class="m-nav__logo" href="/">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 82.9 95.7">
          <title>logo-across</title>
          <path fill="#3CA873" d="M0 23.9l15.9-9.2 41.5 23.9-16 9.2"></path>
          <path fill="#0093D8" d="M25.5 9.2L41.4 0l41.5 23.9-16 9.2"></path>
          <path fill="#53DD99" d="M41.4 95.7l16-9.3V38.6l-16 9.2"></path>
          <path fill="#22CEFA" d="M66.9 80.9l16-9.2V23.9l-16 9.2"></path>
          <path fill="#257A50" d="M12.5 64.5L28.9 55l-16.4-9.4"></path>
          <path fill="#4DBC86" d="M12.5 64.5L28.9 74V55"></path>
        </svg>
        <span>Across</span>
      </a>
    </div>
  </div>
  <div class="m-mobile-menu__container js-mobile-menu-overlay" id="mobile-menu">
    <nav class="m-mobile-menu__list">
      <a href="https://across.foreach.be/blog">Blog</a>
      <a href="https://across.foreach.be/documentation" class="is-active">Docs</a>
      <a href="https://across.foreach.be/modules">Modules</a>
      <a href="https://across.foreach.be/faq">FAQ</a>
      <a href="http://start-across.foreach.be">Get started</a>
    </nav>
  </div>
  <nav class="m-nav is-sticky">
    <a class="m-nav__logo" href="../..">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 82.9 95.7">
        <title>logo-across</title>
        <path fill="#3CA873" d="M0 23.9l15.9-9.2 41.5 23.9-16 9.2"></path>
        <path fill="#0093D8" d="M25.5 9.2L41.4 0l41.5 23.9-16 9.2"></path>
        <path fill="#53DD99" d="M41.4 95.7l16-9.3V38.6l-16 9.2"></path>
        <path fill="#22CEFA" d="M66.9 80.9l16-9.2V23.9l-16 9.2"></path>
        <path fill="#257A50" d="M12.5 64.5L28.9 55l-16.4-9.4"></path>
        <path fill="#4DBC86" d="M12.5 64.5L28.9 74V55"></path>
      </svg>
      <span>Across</span>
    </a>

    <div class="m-nav__link-group">
      <a href="https://across.foreach.be/blog">Blog</a>
      <a href="https://across.foreach.be/documentation" class="is-active">Docs</a>
      <a href="https://across.foreach.be/modules">Modules</a>
      <a href="https://across.foreach.be/faq">FAQ</a>
      <a href="http://start-across.foreach.be">Get started</a>
    </div>
  </nav>
</header>
<div class="main-wrapper">
<div class="navigation-container" data-component="across-autoconfigure" data-version="3.0.0-SNAPSHOT">
  <aside class="navigation">
    <div class="panels">
      <div id="search-box" class="search-box is-active">
        <input id="search-input" type="text" placeholder="Search the documentation">
      </div>
      <div class="navigation-menu is-active" data-panel="menu">
  <nav class="nav-menu">
    <h3 class="title"><a href="index.html">Auto-configuration Support</a></h3>
<ul class="nav-list">
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="index.html">Across &amp; Spring Boot</a>
  </li>
  <li class="nav-item is-current-page" data-depth="1">
    <button class="nav-toggle"></button>
    <a class="nav-link" href="adding-auto-configuration-support.html">Adding auto-configuration support</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="#challenges">Typical challenges</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="#across-configuration">META-INF/across.configuration</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-toggle"></button>
    <a class="nav-link" href="starters/index.html">Supported starters and libraries</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <button class="nav-toggle"></button>
    <a class="nav-link" href="starters/official-starters.html">Official Spring Boot starters</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="starters/spring-cloud.html">Spring Cloud</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="starters/spring-data.html">Spring Data</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="starters/contributed-starters.html">Contributed starters</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="starters/other-libraries.html">Other libraries</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="unsupported.html">Unsupported auto-configurations</a>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-toggle"></button>
    <a class="nav-link" href="releases/index.html">Releases</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="releases/3.x.html#3-0-0">3.x</a>
  </li>
</ul>
  </li>
</ul>
  </li>
</ul>
  </nav>
</div>
      <div class="navigation-explore" data-panel="explore">
  <div class="context">
    <span class="title">Auto-configuration Support</span>
    <span class="version">3.0.0-SNAPSHOT</span>
  </div>
  <ul class="components">
    <li class="component">
      <span class="title">Across Platform</span>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../across/index.html">master</a>
        </li>
        <li class="version">
          <a href="../../across/5.1.0-SNAPSHOT/index.html">5.1.0-SNAPSHOT</a>
        </li>
        <li class="version">
          <a href="../../across/2.1.5/index.html">2.1.5</a>
        </li>
        <li class="version">
          <a href="../../across/2.1.4/index.html">2.1.4</a>
        </li>
        <li class="version">
          <a href="../../across/2.1.3/index.html">2.1.3</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <span class="title">Application Guides</span>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../guides/index.html">master</a>
        </li>
        <li class="version">
          <a href="../../guides/5.1.0-SNAPSHOT/index.html">5.1.0-SNAPSHOT</a>
        </li>
      </ul>
    </li>
    <li class="component is-current">
      <span class="title">Auto-configuration Support</span>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../index.html">master</a>
        </li>
        <li class="version is-current">
          <a href="index.html">3.0.0-SNAPSHOT</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <span class="title">Migration guides</span>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../migration/index.html">master</a>
        </li>
        <li class="version">
          <a href="../../migration/5.1.0-SNAPSHOT/index.html">5.1.0-SNAPSHOT</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <span class="title">Module: Admin Web</span>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../admin-web-module/index.html">master</a>
        </li>
        <li class="version">
          <a href="../../admin-web-module/4.1.0-SNAPSHOT/index.html">4.1.0-SNAPSHOT</a>
        </li>
        <li class="version">
          <a href="../../admin-web-module/3.2.0/index.html">3.2.0</a>
        </li>
        <li class="version">
          <a href="../../admin-web-module/3.1.1/index.html">3.1.1</a>
        </li>
        <li class="version">
          <a href="../../admin-web-module/3.1.0/index.html">3.1.0</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <span class="title">Module: Application Info</span>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../application-info-module/index.html">master</a>
        </li>
        <li class="version">
          <a href="../../application-info-module/2.1.0-SNAPSHOT/index.html">2.1.0-SNAPSHOT</a>
        </li>
        <li class="version">
          <a href="../../application-info-module/1.0.1/index.html">1.0.1</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <span class="title">Module: Batch Processing</span>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../spring-batch-module/index.html">master</a>
        </li>
        <li class="version">
          <a href="../../spring-batch-module/2.1.0-SNAPSHOT/index.html">2.1.0-SNAPSHOT</a>
        </li>
        <li class="version">
          <a href="../../spring-batch-module/1.0.2/index.html">1.0.2</a>
        </li>
        <li class="version">
          <a href="../../spring-batch-module/1.0.1/index.html">1.0.1</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <span class="title">Module: Bootstrap UI</span>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../bootstrap-ui-module/index.html">master</a>
        </li>
        <li class="version">
          <a href="../../bootstrap-ui-module/3.1.0-SNAPSHOT/index.html">3.1.0-SNAPSHOT</a>
        </li>
        <li class="version">
          <a href="../../bootstrap-ui-module/2.2.2/index.html">2.2.2</a>
        </li>
        <li class="version">
          <a href="../../bootstrap-ui-module/2.2.1/index.html">2.2.1</a>
        </li>
        <li class="version">
          <a href="../../bootstrap-ui-module/2.1.1/index.html">2.1.1</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <span class="title">Module: Caching - Ehcache</span>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../ehcache-module/index.html">master</a>
        </li>
        <li class="version">
          <a href="../../ehcache-module/2.1.0-SNAPSHOT/index.html">2.1.0-SNAPSHOT</a>
        </li>
        <li class="version">
          <a href="../../ehcache-module/1.0.1/index.html">1.0.1</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <span class="title">Module: Debug Web</span>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../debug-web-module/index.html">master</a>
        </li>
        <li class="version">
          <a href="../../debug-web-module/3.1.0-SNAPSHOT/index.html">3.1.0-SNAPSHOT</a>
        </li>
        <li class="version">
          <a href="../../debug-web-module/2.0.0/index.html">2.0.0</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <span class="title">Module: Documents & Forms</span>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../dynamic-forms-module/index.html">master</a>
        </li>
        <li class="version">
          <a href="../../dynamic-forms-module/0.2.0-SNAPSHOT/index.html">0.2.0-SNAPSHOT</a>
        </li>
        <li class="version">
          <a href="../../dynamic-forms-module/0.0.3/index.html">0.0.3</a>
        </li>
        <li class="version">
          <a href="../../dynamic-forms-module/0.0.2/index.html">0.0.2</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <span class="title">Module: Entity Management</span>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../entity-module/index.html">master</a>
        </li>
        <li class="version">
          <a href="../../entity-module/4.1.0-SNAPSHOT/index.html">4.1.0-SNAPSHOT</a>
        </li>
        <li class="version">
          <a href="../../entity-module/3.4.0/index.html">3.4.0</a>
        </li>
        <li class="version">
          <a href="../../entity-module/3.3.0/index.html">3.3.0</a>
        </li>
        <li class="version">
          <a href="../../entity-module/3.2.0/index.html">3.2.0</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <span class="title">Module: File Management</span>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../file-manager-module/index.html">master</a>
        </li>
        <li class="version">
          <a href="../../file-manager-module/2.2.0-SNAPSHOT/index.html">2.2.0-SNAPSHOT</a>
        </li>
        <li class="version">
          <a href="../../file-manager-module/2.1.0-SNAPSHOT/index.html">2.1.0-SNAPSHOT</a>
        </li>
        <li class="version">
          <a href="../../file-manager-module/1.4.0/index.html">1.4.0</a>
        </li>
        <li class="version">
          <a href="../../file-manager-module/1.3.0/index.html">1.3.0</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <span class="title">Module: Hibernate JPA</span>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../hibernate-jpa-module/index.html">master</a>
        </li>
        <li class="version">
          <a href="../../hibernate-jpa-module/4.1.0-SNAPSHOT/index.html">4.1.0-SNAPSHOT</a>
        </li>
        <li class="version">
          <a href="../../hibernate-jpa-module/3.0.0/index.html">3.0.0</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <span class="title">Module: LDAP Support</span>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../ldap-module/index.html">master</a>
        </li>
        <li class="version">
          <a href="../../ldap-module/2.1.0-SNAPSHOT/index.html">2.1.0-SNAPSHOT</a>
        </li>
        <li class="version">
          <a href="../../ldap-module/1.0.1/index.html">1.0.1</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <span class="title">Module: Logging</span>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../logging-module/3.1.0-SNAPSHOT/index.html">3.1.0-SNAPSHOT</a>
        </li>
        <li class="version">
          <a href="../../logging-module/1.1.0/index.html">1.1.0</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <span class="title">Module: Mobile Support</span>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../spring-mobile-module/3.1.0-SNAPSHOT/index.html">3.1.0-SNAPSHOT</a>
        </li>
        <li class="version">
          <a href="../../spring-mobile-module/2.0.0/index.html">2.0.0</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <span class="title">Module: Properties</span>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../properties-module/index.html">master</a>
        </li>
        <li class="version">
          <a href="../../properties-module/2.1.0-SNAPSHOT/index.html">2.1.0-SNAPSHOT</a>
        </li>
        <li class="version">
          <a href="../../properties-module/1.1.1/index.html">1.1.1</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <span class="title">Module: Security</span>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../spring-security-module/index.html">master</a>
        </li>
        <li class="version">
          <a href="../../spring-security-module/4.1.0-SNAPSHOT/index.html">4.1.0-SNAPSHOT</a>
        </li>
        <li class="version">
          <a href="../../spring-security-module/3.0.2/index.html">3.0.2</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <span class="title">Module: Security - ACLs</span>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../spring-security-acl-module/index.html">master</a>
        </li>
        <li class="version">
          <a href="../../spring-security-acl-module/4.1.0-SNAPSHOT/index.html">4.1.0-SNAPSHOT</a>
        </li>
        <li class="version">
          <a href="../../spring-security-acl-module/3.0.2/index.html">3.0.2</a>
        </li>
        <li class="version">
          <a href="../../spring-security-acl-module/3.0.1/index.html">3.0.1</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <span class="title">Module: Security - OAuth2</span>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../oauth2-module/3.1.0-SNAPSHOT/index.html">3.1.0-SNAPSHOT</a>
        </li>
        <li class="version">
          <a href="../../oauth2-module/2.1.1/index.html">2.1.1</a>
        </li>
        <li class="version">
          <a href="../../oauth2-module/2.1.0/index.html">2.1.0</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <span class="title">Module: User Management</span>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../user-module/index.html">master</a>
        </li>
        <li class="version">
          <a href="../../user-module/4.1.0-SNAPSHOT/index.html">4.1.0-SNAPSHOT</a>
        </li>
        <li class="version">
          <a href="../../user-module/3.1.1/index.html">3.1.1</a>
        </li>
        <li class="version">
          <a href="../../user-module/3.1.0/index.html">3.1.0</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <span class="title">Module: Web CMS</span>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../web-cms-module/index.html">master</a>
        </li>
        <li class="version">
          <a href="../../web-cms-module/0.2.0-SNAPSHOT/index.html">0.2.0-SNAPSHOT</a>
        </li>
        <li class="version">
          <a href="../../web-cms-module/0.0.7/index.html">0.0.7</a>
        </li>
        <li class="version">
          <a href="../../web-cms-module/0.0.6/index.html">0.0.6</a>
        </li>
      </ul>
    </li>
  </ul>
</div>
    </div>
    <script>
      var indexName = window.location.href.indexOf('across-site/production/')>0 ? 'antora-across-site-production' : 'antora-across-site-preview';
      docsearch({
                  appId: 'YNK2RERBV5',
                  apiKey: '201d66bbf44a6c62002472e491d74568',
                  indexName: indexName,
                  inputSelector: '#search-input',
                  algoliaOptions: { hitsPerPage: 10 }
                })
    </script>
  </aside>
</div>
  <main class="main">
<div class="toolbar" role="navigation">
  <button class="navigation-toggle"></button>
  <a href="../../across/index.html" class="home-link"></a>
<nav class="crumbs" aria-label="breadcrumbs">
  <ul>
    <li class="crumb"><a href="index.html">Auto-configuration Support</a></li>
    <li class="crumb"><a href="adding-auto-configuration-support.html">Adding auto-configuration support</a></li>
  </ul>
</nav>
<div class="page-versions">
  <button class="versions-menu-toggle" title="Show other versions of page">3.0.0-SNAPSHOT</button>
  <div class="versions-menu">
    <a class="version" href="../adding-auto-configuration-support.html">master</a>
    <a class="version is-current" href="adding-auto-configuration-support.html">3.0.0-SNAPSHOT</a>
  </div>
</div>
  <div class="edit-this-page"><a href="https://github.com/ForeachOS/ax-docs-across-autoconfigure/edit/develop-3.0.0/docs/modules/ROOT/pages/adding-auto-configuration-support.adoc">Edit this Page</a></div>
</div>
<article class="doc"><a name="section-top"></a>
      <h1>Adding auto-configuration support</h1>
    <div id="preamble">
<div class="sectionbody">
<div class="paragraph">
<p>When starting a Spring Boot application with <code>@AcrossApplication</code> all auto-configuration classes detected will be considered.
If Across is unsure about what to do with them, you should see the AutoConfiguration Report printed in the logs:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code> --- Across AutoConfiguration Report ---
 The following 2 auto-configuration classes have unknown Across support and were not added:
 - org.springframework.boot.autoconfigure.admin.SpringApplicationAdminJmxAutoConfiguration
 - org.springframework.boot.autoconfigure.aop.AopAutoConfiguration
 Consider adding them to a META-INF/across.configuration.
 --- End Across AutoConfiguration Report ---</code></pre>
</div>
</div>
<div class="paragraph">
<p>This gives you an indication of which classes require a compatibility adapter if you want to use them.
Across will skip these auto-configuration classes but will continue bootstrapping.
If you add a compatible configuration in the right way the warning will disappear, see <a href="#across-configuration">META-INF/across.configuration</a>.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
There is a difference between a not-supported auto-configuration class, and one with unknown support.
The latter should print out the warning in the AutoConfiguration report, the former should be present in an <code>across.configuration</code> so the warning disappears.
</td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect1">
<h2 id="challenges"><a class="anchor" href="#challenges"></a>Auto-configuration problems</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The most common problems to solve have to do with where to put the actual auto-configuration class and which components to expose.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>if it only provides components for direct use by other modules (eg. components from the modules want to inject them)</p>
<div class="ulist">
<ul>
<li>
<p>leave the configuration on application level or move it to a module starting before the modules wishing to use those components</p>
</li>
<li>
<p>when moving to a module, expose the components that other modules want to inject</p>
</li>
<li>
<p><strong>IMPORTANT:</strong> if your configuration uses Spring conditionals depending on components defined inside other modules, it can never remain on the application level as those conditions would never match</p>
</li>
</ul>
</div>
</li>
<li>
<p>if it only uses components provided by other modules</p>
<div class="ulist">
<ul>
<li>
<p>expose those components in the other modules</p>
</li>
<li>
<p>if it does not work when injecting on application level, consider moving to one of the last modules (eg. the <a href="#acrosscontextpostprocessormodule">AcrossContextPostProcessorModule</a></p>
<div class="ulist">
<ul>
<li>
<p>this depends on how the components it needs are looked for, if it does not look up the parent <code>ApplicationContext</code> it would still not detect exposed beans on the application level</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
</li>
<li>
<p>if it does more than one of the above cases</p>
<div class="ulist">
<ul>
<li>
<p>you will need to create a custom configuration class</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
<div class="paragraph">
<p>Some auto-configuration classes need to setup infrastructure in more than one module.
In that case you will also need a custom configuration class that injects the required code in the relevant modules (usually all of them in a case like this).</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="acrosscontextinfraprocessormodule"><a class="anchor" href="#acrosscontextinfraprocessormodule"></a>AcrossContextInfrastructureModule</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Every Across context contains a placeholder module called <strong>AcrossContextInfrastructureModule</strong>.
It usually starts as the very first module.
It can be used as an extension point to move configuration classes to that need to be available for all other modules.</p>
</div>
<div class="paragraph">
<p>If no configuration has been added to the module, it will be skipped and not bootstrap.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="acrosscontextpostprocessormodule"><a class="anchor" href="#acrosscontextpostprocessormodule"></a>AcrossContextPostProcessorModule</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Every Across context contains a placeholder module called <strong>AcrossContextPostProcessorModule</strong>.
It usually starts as the very last module, after the application module.
It can be used to move configuration classes to that need to rely on components defined by all other modules.</p>
</div>
<div class="paragraph">
<p>If no configuration has been added to the module, it will be skipped and not bootstrap.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="across-configuration"><a class="anchor" href="#across-configuration"></a>META-INF/across.configuration</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The <code>across.configuration</code> file allows you to move auto-configuration, exposed additional beans and provide alternative configuration classes.
Every JAR file can contain a single <code>across.configuration</code> and all data from them will be merged together.</p>
</div>
<div class="paragraph">
<p>As only Across interprets these files, existing libraries can add them to support both Across- and non-Across-based application.
The <code>across.configuration</code> should always be located in the <code>META-INF</code> folder in the root of your package.</p>
</div>
<div class="paragraph">
<p>A <code>across.configuration</code> is a properties file supporting 3 property keys that can have comma-separated values:</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">com.foreach.across.Exposed</dt>
<dd>
<p>List of class names for components that should always be exposed by every module.
Class name can be specific or abstract class, interface or annotation.
In case of an annotation, any component with that annotation will be exposed.</p>
</dd>
<dt class="hdlist1">com.foreach.across.AutoConfigurationDisabled</dt>
<dd>
<p>List of configuration classes that should be rejected when requested through Spring Boot auto-configuration.
You will only be able to add these configuration classes directly to your application.</p>
</dd>
<dt class="hdlist1">com.foreach.across.AutoConfigurationEnabled</dt>
<dd>
<p>List of configuration classes that are allowed when requested through Spring Boot auto-configuration.</p>
</dd>
</dl>
</div>
<div class="paragraph">
<p>The <strong>com.foreach.across.AutoConfigurationEnabled</strong> values support multiple options:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>If only the class name is given, the configuration will be added to the application level as is the default Spring Boot behaviour.</p>
</li>
<li>
<p>A replacement class can be specified using <strong>:</strong> after the class name.
In this case the replacement class will be added to the application level instead of the original class.
This is useful for providing an <code><a href="#AcrossBoostrapConfigurer">AcrossBootstrapConfigurer</a></code>.</p>
</li>
<li>
<p>A module name can be specified using <strong>&#8594;</strong> after the class name.
In this case the configuration will not be added to the application level but to the module specified.
You can use <strong>DynamicApplicationModule</strong> as a placeholder name to indicate the configuration should be added to the application module.</p>
<div class="dlist">
<dl>
<dt class="hdlist1">com.foreach.across.IllegalConfiguration</dt>
<dd>
<p>List of class names that are not allowed to be present in a module or context.
These will be validated during startup and if one of these is present, the application will not start up and throw an error.</p>
</dd>
</dl>
</div>
</li>
</ul>
</div>
<div class="paragraph">
<p>The <strong>com.foreach.across.IllegalConfiguration</strong> values support multiple options:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>If only a class name is given, the configuration may not be used in the AcrossContext, which is the root context of the application.
This means that the configuration is not allowed on the level of the <code>*Application</code> class.</p>
</li>
<li>
<p>A module name can be specified using <strong>&#8594;</strong> after the class name.
This means that the configuration is not allowed for the specified module(s).
It is also possible to make a configuration illegal in all modules or in the across application context.</p>
<div class="ulist">
<ul>
<li>
<p>If the module name is equal to <strong>AcrossContext</strong>, beans of the provided type name may not be present in the across application context.</p>
</li>
<li>
<p>If the module name is equal to <strong>AcrossModule</strong>, beans of the provided type may not be present in <strong>ANY</strong> module</p>
</li>
<li>
<p>If the module name is prefixed by an <strong>exclamation mark ( ! )</strong>, it is allowed in that specific module.</p>
</li>
<li>
<p>Multiple module names can be specified using a <strong>pipe  ( | )</strong>.
As an example,  <code>org.springframework.web.servlet.config.annotation.WebMvcConfigurationSupport&#8594;AcrossContext|AcrossModule|!MyModule,</code> means that the configuration may not be used in the across context or in any module, except for <code>MyModule</code>.
By default as soon as a module has been specified, the specified type may not be used in any module except those specified.
So the former example is per se equal to <code>org.springframework.web.servlet.config.annotation.WebMvcConfigurationSupport&#8594;!MyModule,</code></p>
</li>
<li>
<p>The illegal configuration can be suffixed by a <strong>colon ( : )</strong> followed by a message key.
This key can then be used to specify more information about why beans of that type are not allowed, as well as the action(s) that should be taken.
This is done through the use of the following entries in the <code>across.configuration</code> file:</p>
<div class="ulist">
<ul>
<li>
<p><code>com.foreach.across.IllegalConfiguration[MESSAGE_KEY].description=</code> Why this is an illegal configuration</p>
</li>
<li>
<p><code>com.foreach.across.IllegalConfiguration[MESSAGE_KEY].action=</code> A possible resolution or steps to take</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
</li>
</ul>
</div>
<div class="listingblock">
<div class="title">Example META-INF/across.configuration</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-properties hljs" data-lang="properties">#
# Lists the classes (or annotations) of components that should always be exposed
#
com.foreach.across.Exposed=\
  org.springframework.stereotype.Service
#
# List of AutoConfiguration classes that should never be allowed.
# Once a class has been added here, it can only ever be added manually to the application.
#
com.foreach.across.AutoConfigurationDisabled=\
  my.IncompatibleAutoConfiguration
#
#
# List of AutoConfiguration classes that are supported on the application level, these will be allowed unless disabled.
# Optionally an adapter class name or a module target can be specified.
#
com.foreach.across.AutoConfigurationEnabled=\
  my.CompatibleAutoConfiguration,\
  my.ReplacedIncompatibleAutoConfiguration:my.AcrossAnotherIncompatibleAutoConfigurationAdapter,\
  my.ApplicationModuleInjectedAutoConfiguration-&gt;DynamicApplicationModule,\
  my.PostProcessorModuleInjectedAutoConfiguration-&gt;AcrossContextPostProcessorModule

#
# List of AutoConfiguration classes or bean types that are not allowed to be present (in the specified modules).
#
com.foreach.across.IllegalConfiguration=\
  my.SimpleConfiguration-&gt;AcrossContext:mydescriptionlabel
  my.SomeBean-&gt;!AcrossContextPostProcessorModule

#
# List of illegal configuration descriptions.
#
com.foreach.across.IllegalConfiguration[mydescriptionlabel].description=This configuration is not allowed to be present on the AcrossContext.
com.foreach.across.IllegalConfiguration[mydescriptionlabel].action=Remove this configuration on the AcrossApplication level.</code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
Some auto-configuration classes use the <code>AutoConfigurationPackage</code> for scanning components.
In an Across application, only the package of the application module is automatically registered as an <code>AutoConfigurationPackage</code>.
In a regular Spring Boot application, it would be the package that contains the <code>@SpringBootApplication</code> class.
</td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect1">
<h2 id="AcrossBoostrapConfigurer"><a class="anchor" href="#AcrossBoostrapConfigurer"></a>AcrossBootstrapConfigurer</h2>
<div class="sectionbody">
<div class="paragraph">
<p>See <a href="../../across/developing-applications/extend-module-configuration.html" class="page">Extend module configuration</a></p>
</div>
</div>
</div>
    <div class="article-footer-nav">
        <a class="article-footer-nav-previous" href="index.html">&laquo; Across &amp; Spring Boot</a>
            <span class="article-footer-nav-current">Adding auto-configuration support</span>
        <a class="article-footer-nav-next" href="#challenges">Typical challenges &raquo;</a>
    </div>
</article>
<aside class="article-aside hidden" role="navigation">
  <h3 class="toc-title">Contents</h3>
  <div id="article-toc"></div>
</aside>
  </main>
</div>
<footer class="footer">
  <p>The Across documentation site is generated using <a href="https://antora.org" target="_blank">Antora</a>.</p>
  <div class="footer-totop">
    <!--srcset="/acrossWebsite/img/foreach-logo@2x.png 2x"-->
    <a class="footer-partner" href="http://foreach.be/" target="_blank">
      sponsored by <svg width="20" height="20" viewBox="0 0 277 311" xmlns="http://www.w3.org/2000/svg">
        <g fill="none" fill-rule="evenodd">
          <path d="M27 307.3V133.5H.9V92.7H27v-8.8c0-24.1 4.3-46.5 19.7-64.1C58.2 6.6 74.7.1 92.9.1c13.4 0 23.7 2.2 31.2 4.8l-5.9 44.8c-3.9-1.8-9.5-2.6-15.8-2.6-17.4 0-23.7 16.7-23.7 35.5v10.1h33.6v40.8H78.7v173.8H27z" fill="#FFCE01" fill-rule="nonzero"></path>
          <path d="M229.2 181c0-27.6-6.3-49.1-21.7-49.1-17 0-23.7 27.7-24.1 49.1h45.8zM183 221.4c.8 33.4 18.2 45.6 41.1 45.6 14.6 0 27.6-3.5 36.7-7l7.1 41.2c-13.4 5.7-33.6 9.7-53.3 9.7-52.5 0-81.4-38.6-81.4-105.8 0-72 33.6-115 77.4-115 41.5 0 65.6 36.4 65.6 101.4 0 15.4-.4 23.7-1.6 29.8H183v.1z" fill="#FFF" fill-rule="nonzero"></path>
        </g>
      </svg>
    </a>
    <a href="#section-top">
      <svg width="34" height="34" viewBox="0 0 62 62" xmlns="http://www.w3.org/2000/svg">
        <title>icon</title>
        <g transform="rotate(-90 30.5 30.5)" fill="none" fill-rule="evenodd">
          <circle stroke="#ffffff" fill="#1D2A3A" transform="rotate(180 30.007 30.942)" cx="30.007" cy="30.942" r="30"></circle>
          <path fill="#ffffff" d="M25 38.884h3.713l6.3-7.797-6.3-8.087-3.713.064 6.155 7.972"></path>
        </g>
      </svg>
    </a>
  </div>
</footer>
<script src="https://cdnjs.cloudflare.com/ajax/libs/tocbot/4.1.1/tocbot.min.js"></script>
<script src="../../_/js/site.js"></script>
<script src="../../_/js/vendor/highlight.js"></script>
<script>hljs.initHighlighting()</script>
<script>
  tocbot.init( {
                 tocSelector: '#article-toc',
                 contentSelector: 'article',
                 headingSelector: 'h2, h3, h4',
                 collapseDepth: 3,
                 positionFixedSelector: '#article-toc',
                 scrollSmooth: false
               } );
  var tocList = document.getElementById( 'article-toc' ).getElementsByClassName( 'toc-list' );
  if ( tocList && tocList.length > 0 && tocList[0].childNodes.length > 0 ) {
    document.getElementById( 'article-toc' ).parentNode.classList.remove( 'hidden' );
  }
</script>
  </body>
</html>
