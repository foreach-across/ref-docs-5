<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Creating an application and modules - Across</title>
    <meta name="generator" content="Antora 2.0.0">
    <link rel="stylesheet" href="../../../_/css/site.css">
<link href="https://fonts.googleapis.com/css?family=Open+Sans:300,400,600,700,800" rel="stylesheet">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/docsearch.js@2/dist/cdn/docsearch.min.css" />
<script type="text/javascript" src="https://cdn.jsdelivr.net/npm/docsearch.js@2/dist/cdn/docsearch.min.js"></script>
<meta name="og:title" content="Across Documentation"/>
<meta name="og:image" content="https://across.foreach.be/across/resources/static/acrossWebsite/img/og-image-across.jpg"/>
<link rel="icon" type="image/png" sizes="16x16" href="https://across.foreach.be/across/resources/static/acrossWebsite/img/favicon/favicon-16x16.png"/>
<link rel="icon" type="image/png" sizes="32x32" href="https://across.foreach.be/across/resources/static/acrossWebsite/img/favicon/favicon-32x32.png"/>
<link rel="icon" type="image/png" sizes="96x96" href="https://across.foreach.be/across/resources/static/acrossWebsite/img/favicon/favicon-96x96.png"/>
<link rel="apple-touch-icon" type="image/png" href="https://across.foreach.be/across/resources/static/acrossWebsite/img/favicon/apple-icon-120x120.png"/>
<link rel="apple-touch-icon" type="image/png" sizes="152x152" href="https://across.foreach.be/across/resources/static/acrossWebsite/img/favicon/apple-icon-152x152.png"/>
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="https://across.foreach.be/across/resources/static/acrossWebsite/img/favicon/apple-icon-180x180.png"/>
  </head>
  <body class="article">
<header class="header" role="banner">
  <div class="m-mobile-menu__button js-overlay-menu-button" data-target="mobile-menu">
    <span class="m-mobile-menu__line"></span>
    <span class="m-mobile-menu__line"></span>
    <span class="m-mobile-menu__line"></span>
  </div>

  <div class="m-mobile-menu">
    <div class="m-mobile-menu__logo">
      <a class="m-nav__logo" href="/">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 82.9 95.7">
          <title>logo-across</title>
          <path fill="#3CA873" d="M0 23.9l15.9-9.2 41.5 23.9-16 9.2"></path>
          <path fill="#0093D8" d="M25.5 9.2L41.4 0l41.5 23.9-16 9.2"></path>
          <path fill="#53DD99" d="M41.4 95.7l16-9.3V38.6l-16 9.2"></path>
          <path fill="#22CEFA" d="M66.9 80.9l16-9.2V23.9l-16 9.2"></path>
          <path fill="#257A50" d="M12.5 64.5L28.9 55l-16.4-9.4"></path>
          <path fill="#4DBC86" d="M12.5 64.5L28.9 74V55"></path>
        </svg>
        <span>Across</span>
      </a>
    </div>
  </div>
  <div class="m-mobile-menu__container js-mobile-menu-overlay" id="mobile-menu">
    <nav class="m-mobile-menu__list">
      <a href="https://across.foreach.be/blog">Blog</a>
      <a href="https://across.foreach.be/documentation" class="is-active">Docs</a>
      <a href="https://across.foreach.be/modules">Modules</a>
      <a href="https://across.foreach.be/faq">FAQ</a>
      <a href="http://start-across.foreach.be">Get started</a>
    </nav>
  </div>
  <nav class="m-nav is-sticky">
    <a class="m-nav__logo" href="../../..">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 82.9 95.7">
        <title>logo-across</title>
        <path fill="#3CA873" d="M0 23.9l15.9-9.2 41.5 23.9-16 9.2"></path>
        <path fill="#0093D8" d="M25.5 9.2L41.4 0l41.5 23.9-16 9.2"></path>
        <path fill="#53DD99" d="M41.4 95.7l16-9.3V38.6l-16 9.2"></path>
        <path fill="#22CEFA" d="M66.9 80.9l16-9.2V23.9l-16 9.2"></path>
        <path fill="#257A50" d="M12.5 64.5L28.9 55l-16.4-9.4"></path>
        <path fill="#4DBC86" d="M12.5 64.5L28.9 74V55"></path>
      </svg>
      <span>Across</span>
    </a>

    <div class="m-nav__link-group">
      <a href="https://across.foreach.be/blog">Blog</a>
      <a href="https://across.foreach.be/documentation" class="is-active">Docs</a>
      <a href="https://across.foreach.be/modules">Modules</a>
      <a href="https://across.foreach.be/faq">FAQ</a>
      <a href="http://start-across.foreach.be">Get started</a>
    </div>
  </nav>
</header>
<div class="main-wrapper">
<div class="navigation-container" data-component="guides" data-version="2.1.2">
  <aside class="navigation">
    <div class="panels">
      <div id="search-box" class="search-box is-active">
        <input id="search-input" type="text" placeholder="Search the documentation">
      </div>
      <div class="navigation-menu is-active" data-panel="menu">
  <nav class="nav-menu">
    <h3 class="title"><a href="../index.html">Application Guides</a></h3>
<ul class="nav-list">
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <button class="nav-toggle"></button>
    <a class="nav-link" href="index.html">Building a modular monolith</a>
<ul class="nav-list">
  <li class="nav-item is-current-page" data-depth="2">
    <a class="nav-link" href="1-creating-a-module.html">Applications and modules</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="2-module-dependencies.html">Module dependencies</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="3-using-module-components.html">Using module components</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="4-working-with-events.html">Working with events</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="5-dynamic-application-module.html">Dynamic application module</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-toggle"></button>
    <a class="nav-link" href="../security/oauth2-sso.html">Adding security</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../security/oauth2-sso.html">OAuth2 with Single-Sign On</a>
  </li>
</ul>
  </li>
</ul>
  </li>
</ul>
  </nav>
</div>
      <div class="navigation-explore" data-panel="explore">
  <div class="context">
    <span class="title">Application Guides</span>
    <span class="version">2.1.2</span>
  </div>
  <ul class="components">
    <li class="component">
      <span class="title">Across Platform</span>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../../across/2.1.4/index.html">2.1.4</a>
        </li>
        <li class="version">
          <a href="../../../across/2.1.3/index.html">2.1.3</a>
        </li>
      </ul>
    </li>
    <li class="component is-current">
      <span class="title">Application Guides</span>
      <ul class="versions">
        <li class="version is-current is-latest">
          <a href="../index.html">2.1.2</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <span class="title">Auto-configuration Support</span>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../../across-autoconfigure/1.0.2/index.html">1.0.2</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <span class="title">Migration guides</span>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../../migration/2.1.2/index.html">2.1.2</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <span class="title">Module: Admin Web</span>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../../admin-web-module/3.1.1/index.html">3.1.1</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <span class="title">Module: Application Info</span>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../../application-info-module/1.0.1/index.html">1.0.1</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <span class="title">Module: Batch Processing</span>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../../spring-batch-module/1.0.2/index.html">1.0.2</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <span class="title">Module: Bootstrap UI</span>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../../bootstrap-ui-module/2.2.1/index.html">2.2.1</a>
        </li>
        <li class="version">
          <a href="../../../bootstrap-ui-module/2.1.1/index.html">2.1.1</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <span class="title">Module: Caching - Ehcache</span>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../../ehcache-module/1.0.1/index.html">1.0.1</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <span class="title">Module: Debug Web</span>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../../debug-web-module/2.0.0/index.html">2.0.0</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <span class="title">Module: Documents & Forms</span>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../../dynamic-forms-module/0.0.3/index.html">0.0.3</a>
        </li>
        <li class="version">
          <a href="../../../dynamic-forms-module/0.0.2/index.html">0.0.2</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <span class="title">Module: Entity Management</span>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../../entity-module/3.3.0/index.html">3.3.0</a>
        </li>
        <li class="version">
          <a href="../../../entity-module/3.2.0/index.html">3.2.0</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <span class="title">Module: File Management</span>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../../file-manager-module/1.4.0/index.html">1.4.0</a>
        </li>
        <li class="version">
          <a href="../../../file-manager-module/1.3.0/index.html">1.3.0</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <span class="title">Module: Hibernate JPA</span>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../../hibernate-jpa-module/3.0.0/index.html">3.0.0</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <span class="title">Module: LDAP Support</span>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../../ldap-module/1.0.1/index.html">1.0.1</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <span class="title">Module: Logging</span>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../../logging-module/1.1.0/index.html">1.1.0</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <span class="title">Module: Mobile Support</span>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../../spring-mobile-module/2.0.0/index.html">2.0.0</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <span class="title">Module: Properties</span>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../../properties-module/1.1.1/index.html">1.1.1</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <span class="title">Module: Security</span>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../../spring-security-module/3.0.2/index.html">3.0.2</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <span class="title">Module: Security - ACLs</span>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../../spring-security-acl-module/3.0.2/index.html">3.0.2</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <span class="title">Module: Security - OAuth2</span>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../../oauth2-module/2.1.1/index.html">2.1.1</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <span class="title">Module: User Management</span>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../../user-module/3.1.1/index.html">3.1.1</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <span class="title">Module: Web CMS</span>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../../web-cms-module/0.0.7/index.html">0.0.7</a>
        </li>
        <li class="version">
          <a href="../../../web-cms-module/0.0.6/index.html">0.0.6</a>
        </li>
      </ul>
    </li>
  </ul>
</div>
    </div>
    <script>
      var indexName = window.location.href.indexOf('across-site/production/')>0 ? 'antora-across-site-production' : 'antora-across-site-preview';
      docsearch({
                  appId: 'YNK2RERBV5',
                  apiKey: '201d66bbf44a6c62002472e491d74568',
                  indexName: indexName,
                  inputSelector: '#search-input',
                  algoliaOptions: { hitsPerPage: 10 }
                })
    </script>
  </aside>
</div>
  <main class="main">
<div class="toolbar" role="navigation">
  <button class="navigation-toggle"></button>
  <a href="../../../across/2.1.4/index.html" class="home-link"></a>
<nav class="crumbs" aria-label="breadcrumbs">
  <ul>
    <li class="crumb"><a href="../index.html">Application Guides</a></li>
    <li class="crumb"><a href="index.html">Building a modular monolith</a></li>
    <li class="crumb"><a href="1-creating-a-module.html">Applications and modules</a></li>
  </ul>
</nav>
  <div class="edit-this-page"><a href="https://github.com/ForeachOS/ax-docs-platform/edit/master/docs/guides/modules/ROOT/pages/modular-monoliths/1-creating-a-module.adoc">Edit this Page</a></div>
</div>
<article class="doc"><a name="section-top"></a>
      <h1>Creating an application and modules</h1>
    <div id="preamble">
<div class="sectionbody">
<div class="quoteblock abstract">
<blockquote>
<div class="paragraph">
<p>This section covers the basics of creating an Across application and module, it shows how to:</p>
</div>
<div class="ulist checklist">
<ul class="checklist">
<li>
<p><i class="fa fa-check-square-o"></i> Create a new Across application using the initializr</p>
</li>
<li>
<p><i class="fa fa-check-square-o"></i> Run and test your application</p>
</li>
<li>
<p><i class="fa fa-check-square-o"></i> Define a custom Across module and add it to your application</p>
</li>
<li>
<p><i class="fa fa-check-square-o"></i> Test your Across module separately</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>This how-to is part of the <a href="index.html" class="page">Building a modular monolith</a> series.</p>
</div>
</blockquote>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_creating_our_application"><a class="anchor" href="#_creating_our_application"></a>Creating our application</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Let&#8217;s start by creating our Spring Boot application.</p>
</div>
<div class="paragraph">
<p>Go to <a href="http://start-across.foreach.be" class="bare">http://start-across.foreach.be</a> and ensure that the option <code>Blank Across application without any modules</code> is selected.
Click on <code>Generate project</code>, download, unzip to a folder and import the project via the <code>pom.xml</code> in your favorite IDE.</p>
</div>
<div class="paragraph">
<p>When unzipped, you should see the following folder structure:</p>
</div>
<div class="listingblock">
<div class="title">Project structure</div>
<div class="content">
<pre class="highlightjs highlight"><code>src/
  main/
    java/
      com/example/demo/
        application/
        DemoApplication.java
    resources/
      application.yml
      application-dev.yml
      application-prod.yml
      build.properties
  test/
    java/
      com/example/demo/application/
      it/
        ITDemoApplication.java
.gitignore
README.md
lombok.config
pom.xml</code></pre>
</div>
</div>
<div class="paragraph">
<p>There&#8217;s only 2 java classes added:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>DemoApplication</code> which represents the Spring Boot application</p>
</li>
<li>
<p><code>ITDemoApplication</code> which is an integration test for bootstrapping the application</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Let&#8217;s a have quick look at the source code of <code>DemoApplication</code>:</p>
</div>
<div class="listingblock">
<div class="title">src/main/java/com/example/demo/DemoApplication.java</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">@AcrossApplication(
		modules = {

		}
)
public class DemoApplication
{
	public static void main( String[] args ) {
		SpringApplication springApplication = new SpringApplication( DemoApplication.class );
		springApplication.setDefaultProperties( Collections.singletonMap( "spring.config.location", "${user.home}/dev-configs/demo-application.yml" ) );
		springApplication.run( args );
	}
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>This is run as a <code>SpringApplication</code> but instead of <code>@SpringBootApplication</code> the class is annotated with <code>@AcrossApplication</code> signaling we want to bootstrap as a modular application based on Across.</p>
</div>
<div class="paragraph">
<p>In an Across application we also call this file the <strong>application descriptor</strong>.</p>
</div>
<div class="paragraph">
<p>Currently our application descriptor is empty, there are no modules added to it.
Let&#8217;s boot up our newly created application.</p>
</div>
<div class="sect2">
<h3 id="_run_the_application"><a class="anchor" href="#_run_the_application"></a>Run the application</h3>
<div class="paragraph">
<p>You can simply execute the <code>DemoApplication</code> <code>main</code> method to run the application.
From a terminal you can also use the following command:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>$ mvn spring-boot:run</pre>
</div>
</div>
<div class="paragraph">
<p>When starting up the application, you should find the following in the console output:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code>: ---
: AcrossContext: DemoApplication (AcrossContext-1)
: Bootstrapping 2 modules in the following order:
: 1 - DemoApplicationModule [resources: demo]: class com.foreach.across.core.DynamicAcrossModule$DynamicApplicationModule
: 2 - AcrossContextPostProcessorModule [resources: AcrossContextPostProcessorModule]: class com.foreach.across.core.AcrossContextConfigurationModule
: ---</code></pre>
</div>
</div>
<div class="paragraph">
<p>This is a very important piece of information for our application: it tells us which modules are being started and in which order.
We will come back to this later on, but you should make sure you can always easily retrieve this from the logs.</p>
</div>
<div class="paragraph">
<p>Even though we don&#8217;t specify any modules ourselves, we can see that the application bootstraps 2 modules that are added by default.
You can ignore these for now, we&#8217;ll explain them towards the end of this post.</p>
</div>
</div>
<div class="sect2">
<h3 id="_testing_the_application"><a class="anchor" href="#_testing_the_application"></a>Testing the application</h3>
<div class="paragraph">
<p>Apart from running the main class, you should also be able to run the integration test: <code>ITDemoApplication</code>.</p>
</div>
<div class="paragraph">
<p>If you want to run all integration tests from the terminal, you can do:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>$ mvn integration-test</pre>
</div>
</div>
<div class="paragraph">
<p>But usually I just execute the test class or test method directly from the IDE.</p>
</div>
<div class="paragraph">
<p>The integration tests bootstraps the entire <code>DemoApplication</code> as well, and is pre-configured for a Spring MVC testing scenario (using <code>MockMvc</code>).
We won&#8217;t be using that in the rest of this tutorial however.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_adding_a_component"><a class="anchor" href="#_adding_a_component"></a>Adding a component</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Now that we can boot up our application, let&#8217;s add some code to it.
Let&#8217;s start by adding a component in the same package as the <code>DemoApplication</code> class.</p>
</div>
<div class="listingblock">
<div class="title">src/main/java/com/example/demo/ComponentOne.java</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">package com.example.demo;

@Component
@Slf4j
public class ComponentOne
{
	public ComponentOne() {
		LOG.info( "Component created: {}", getClass() );
	}
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>This class declares a simple bean component that should get instantiated when Spring scans the package for all classes annotated with <code>@Component</code>.
However, when you re-run the application integration test, you <strong>should not find</strong> the test <em>Component created</em> anywhere, meaning our component actually did not get created.</p>
</div>
<div class="admonitionblock warning">
<table>
<tr>
<td class="icon">
<i class="fa icon-warning" title="Warning"></i>
</td>
<td class="content">
If you do find the output, you probably added the component to the <code>application</code> child package.
Move it next to the <code>DemoApplication</code> instead, we will explain the purpose of the <code>application</code> package at the end of this post.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>In a regular <code>@SpringBootApplication</code> we would expect Spring Boot to scan the root package and all child packages below for components.
An <code>@AcrossApplication</code> however encourages you to bundle your components in separate modules, and to only treat the application class as a descriptor for which modules should be added.</p>
</div>
<div class="paragraph">
<p>In fact, if you were to manually add a <code>@ComponentScan</code> directly on the <code>DemoApplication</code> class, starting the application would fail altogether (with a specific error message).</p>
</div>
<div class="paragraph">
<p>In order to continue, we must put our component in an Across module.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_creating_an_across_module"><a class="anchor" href="#_creating_an_across_module"></a>Creating an Across module</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Every module is identified by a unique name and a <em>module descriptor</em>, a class extending <code>AcrossModule</code>.
As a convention and to help you separate your code, each module usually resides in its own base package.</p>
</div>
<div class="paragraph">
<p>Let&#8217;s create a package <code>com.example.demo.modules.one</code> and add a module descriptor to it:</p>
</div>
<div class="listingblock">
<div class="title">src/main/java/com/example/demo/modules/one/ModuleOne.java</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">package com.example.demo.modules.one;

public class ModuleOne extends AcrossModule
{
	public static final String NAME = "ModuleOne";

	@Override
	public String getName() {
		return NAME;
	}

	@Override
	protected void registerDefaultApplicationContextConfigurers( Set&lt;ApplicationContextConfigurer&gt; contextConfigurers ) {
		contextConfigurers.add( ComponentScanConfigurer.forAcrossModule( ModuleOne.class ) );
	}
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>This class is a module descriptor that defines a module named <code>ModuleOne</code>, and configures it so it scans its package for components when starting up.</p>
</div>
<div class="paragraph">
<p>Let&#8217;s move the previously created <code>ComponentOne</code> to the same package and rename it to <code>InternalComponentOne</code>.</p>
</div>
<div class="listingblock">
<div class="title">src/main/java/com/example/demo/modules/one/InternalComponentOne.java</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">package com.example.demo.modules.one;

@Component
@Slf4j
public class InternalComponentOne
{
	public InternalComponentOne() {
		LOG.info( "Component created: {}", getClass() );
	}
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>You should end up with the following project structure:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code>com.example.demo/
  modules/
    one/
      ModuleOne
      InternalComponentOne
  DemoApplication</code></pre>
</div>
</div>
<div class="paragraph">
<p>We have defined a new module (<code>ModuleOne</code>) which will contain a single component (<code>InternalComponentOne</code>) when it is started.
All that&#8217;s left to do is to add our newly defined module to our application.
We can do that by adding the module descriptor as a bean in the <code>DemoApplication</code>:</p>
</div>
<div class="listingblock">
<div class="title">src/main/java/com/example/demo/DemoApplication.java</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">@AcrossApplication(
public class DemoApplication {
    @Bean
    public ModuleOne moduleOne() {
        return new ModuleOne();
    }

    ...
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>If you now run the integration test or re-start the application, you should see that <code>ModuleOne</code> was added and that <code>InternalComponentOne</code> got created.</p>
</div>
<div class="listingblock">
<div class="title">Console output excerpt</div>
<div class="content">
<pre class="highlightjs highlight"><code>: ---:
: AcrossContext: DemoApplication (AcrossContext-1)
: Bootstrapping 3 modules in the following order:
: 1 - ModuleOne [resources: ModuleOne]: class com.example.demo.modules.one.ModuleOne
: 2 - DemoApplicationModule [resources: demo]: class com.foreach.across.core.DynamicAcrossModule$DynamicApplicationModule
: 3 - AcrossContextPostProcessorModule [resources: AcrossContextPostProcessorModule]: class com.foreach.across.core.AcrossContextConfigurationModule
: ---
: ...
: --- Starting module bootstrap
:
: 1 - ModuleOne [resources: ModuleOne]: class com.example.demo.modules.one.ModuleOne
: Refreshing ModuleOne: startup date [Wed Sep 26 08:57:46 CEST 2018]; parent: AcrossContext-1
: ...
: Component created: class com.example.demo.modules.one.InternalComponentOne
:
: 2 - DemoApplicationModule [resources: demo]: class com.foreach.across.core.DynamicAcrossModule$DynamicApplicationModule</code></pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_testing_an_across_module_in_isolation"><a class="anchor" href="#_testing_an_across_module_in_isolation"></a>Testing an Across module in isolation</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Part of the modularization aspect is that it should help you define and manage your dependencies.
As such it is also important that you can test your modules in isolation: with the minimum set of required dependencies.</p>
</div>
<div class="paragraph">
<p>Our newly created <code>ModuleOne</code> does not declare any explicit dependencies on other modules.
So let&#8217;s create a separate integration test that bootstraps our module all by itself.</p>
</div>
<div class="paragraph">
<p>We can do so by using the <code>across-test</code> features that have automatically been added to the project.</p>
</div>
<div class="paragraph">
<p>Create a new test class which we will use for separate module integration testing:</p>
</div>
<div class="listingblock">
<div class="title">src/test/java/test/TestModuleBootstrapScenarios.java</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">@Slf4j
public class TestModuleBootstrapScenarios
{
	@Test
	public void moduleOneShouldBootstrapInIsolation() {
		try (AcrossTestContext ignore = AcrossTestBuilders.standard( false )
		                                                  .modules( new ModuleOne() )
		                                                  .build()) {
			LOG.trace( "Bootstrap successful." );
		}
	}
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>This test creates an Across context configuration that only starts <code>ModuleOne</code>.
Since we do not need any web features, we create a <code>standard</code> configuration.
And since we do not require a database, we disable the default test datasource (the <code>false</code> argument).
The latter simply ensures that our test executes a bit faster.</p>
</div>
<div class="paragraph">
<p>We&#8217;re using a try-with-resources approach to ensure that everything gets cleaned up nicely afterwards.
Our test simply checks that starting up works and writes a log message, we don&#8217;t validate anything else.</p>
</div>
<div class="paragraph">
<p>You should now have the following structure for your test code:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code>src/
  test/
    java
      com.example.demo/
      it/
        ITDemoApplication.java
      test/
        TestModuleBootstrapScenarios.java</code></pre>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">A note about the tests package structure</div>
<div class="paragraph">
<p>We have created no less than 3 package structures for our tests.
This is not any form of requirement but simply a conventional approach we prefer:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>com.example.demo</code> contains the actual unit tests, often tests that reside in the same package as the units of code they are testing</p>
</li>
<li>
<p><code>test</code> contains partial integration tests, integration tests for "parts of the application"</p>
</li>
<li>
<p><code>it</code> contains the full-stack integration tests, in this case tests that bootstrap the entire application</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>In the Maven configuration provided by the initializr, the <code>it</code> integration tests are only run with the <code>integration-test</code> goal, whereas all others are executed when using <code>mvn test</code>.</p>
</div>
</div>
</div>
<div class="paragraph">
<p>You should be able to execute test <code>moduleOneShouldBootstrapInIsolation()</code> successfully and find the following in the console output:</p>
</div>
<div class="listingblock">
<div class="title">Test console output excerpt</div>
<div class="content">
<pre class="highlightjs highlight"><code>---
AcrossContext: AcrossContext-1 (AcrossContext-1)
Bootstrapping 2 modules in the following order:
1 - ModuleOne [resources: ModuleOne]: class com.example.demo.modules.one.ModuleOne
2 - AcrossContextPostProcessorModule [resources: AcrossContextPostProcessorModule]: class com.foreach.across.core.AcrossContextConfigurationModule
---</code></pre>
</div>
</div>
<div class="paragraph">
<p>The <code>DemoApplicationModule</code> - a feature of using the <code>@AcrossApplication</code> annotation - is now no longer available.
The <code>AcrossContextPostProcessorModule</code> is automatically added by the Across framework and cannot be removed, it always exists.</p>
</div>
<div class="sect2">
<h3 id="_cleaning_up_the_test_logging_output"><a class="anchor" href="#_cleaning_up_the_test_logging_output"></a>Cleaning up the test logging output</h3>
<div class="paragraph">
<p>You might notice that you get a lot more logging output when running this unit test.
This is because when using <code>@AcrossApplication</code> a default logging configuration gets initialized, but that is not the case when using the <code>AcrossTestBuilders</code>.</p>
</div>
<div class="paragraph">
<p>The easiest way to fix this is to provide a <code>logback-test.xml</code> in your test resources, and to import a pre-configured sample configuration which comes with the <code>across-test</code> dependency.</p>
</div>
<div class="listingblock">
<div class="title">src/test/resources/logback-test.xml</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-xml hljs" data-lang="xml">&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;configuration&gt;
	&lt;include resource="logback-across-test.xml"/&gt;
&lt;/configuration&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>When added correctly, this should be the full console output of running <code>moduleOneShouldBootstrapInIsolation()</code>:</p>
</div>
<div class="listingblock">
<div class="title">Console output with logback-test.xml in place</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-xml hljs" data-lang="xml">AcrossBootstrapper: ---
AcrossBootstrapper: AcrossContext: AcrossContext-1 (AcrossContext-1)
AcrossBootstrapper: Bootstrapping 2 modules in the following order:
AcrossBootstrapper: 1 - ModuleOne [resources: ModuleOne]: class com.example.demo.modules.one.ModuleOne
AcrossBootstrapper: 2 - AcrossContextPostProcessorModule [resources: AcrossContextPostProcessorModule]: class com.foreach.across.core.AcrossContextConfigurationModule
AcrossBootstrapper: ---
AcrossConfig: Creating a default ConversionService as no valid bean 'conversionService' is present
AcrossBootstrapper:
AcrossBootstrapper: --- Starting module bootstrap
AcrossBootstrapper:
AcrossBootstrapper: 1 - ModuleOne [resources: ModuleOne]: class com.example.demo.modules.one.ModuleOne
AcrossDevelopmentMode: Across development mode active: false
InternalComponentOne: Component created: class com.example.demo.modules.one.InternalComponentOne
AcrossBootstrapper:
AcrossBootstrapper: 2 - AcrossContextPostProcessorModule [resources: AcrossContextPostProcessorModule]: class com.foreach.across.core.AcrossContextConfigurationModule
AcrossBootstrapper: Nothing to be done - disabling module
AcrossBootstrapper: --- Module bootstrap finished: 1 modules started
AcrossBootstrapper:
AcrossContext: Shutdown signal received - destroying ApplicationContext instances</code></pre>
</div>
</div>
<div class="paragraph">
<p>So far we have added a single module to our application, and tested it in isolation.
Let&#8217;s make things a bit more interesting and <a href="2-module-dependencies.html" class="page">add a second module</a>.</p>
</div>
</div>
</div>
</div>
    <div class="article-footer-nav">
        <a class="article-footer-nav-previous" href="index.html">&laquo; Building a modular monolith</a>
            <span class="article-footer-nav-current">Applications and modules</span>
        <a class="article-footer-nav-next" href="2-module-dependencies.html">Module dependencies &raquo;</a>
    </div>
</article>
<aside class="article-aside hidden" role="navigation">
  <h3 class="toc-title">Contents</h3>
  <div id="article-toc"></div>
</aside>
  </main>
</div>
<footer class="footer">
  <p>The Across documentation site is generated using <a href="https://antora.org" target="_blank">Antora</a>.</p>
  <div class="footer-totop">
    <!--srcset="/acrossWebsite/img/foreach-logo@2x.png 2x"-->
    <a class="footer-partner" href="http://foreach.be/" target="_blank">
      sponsored by <svg width="20" height="20" viewBox="0 0 277 311" xmlns="http://www.w3.org/2000/svg">
        <g fill="none" fill-rule="evenodd">
          <path d="M27 307.3V133.5H.9V92.7H27v-8.8c0-24.1 4.3-46.5 19.7-64.1C58.2 6.6 74.7.1 92.9.1c13.4 0 23.7 2.2 31.2 4.8l-5.9 44.8c-3.9-1.8-9.5-2.6-15.8-2.6-17.4 0-23.7 16.7-23.7 35.5v10.1h33.6v40.8H78.7v173.8H27z" fill="#FFCE01" fill-rule="nonzero"></path>
          <path d="M229.2 181c0-27.6-6.3-49.1-21.7-49.1-17 0-23.7 27.7-24.1 49.1h45.8zM183 221.4c.8 33.4 18.2 45.6 41.1 45.6 14.6 0 27.6-3.5 36.7-7l7.1 41.2c-13.4 5.7-33.6 9.7-53.3 9.7-52.5 0-81.4-38.6-81.4-105.8 0-72 33.6-115 77.4-115 41.5 0 65.6 36.4 65.6 101.4 0 15.4-.4 23.7-1.6 29.8H183v.1z" fill="#FFF" fill-rule="nonzero"></path>
        </g>
      </svg>
    </a>
    <a href="#section-top">
      <svg width="34" height="34" viewBox="0 0 62 62" xmlns="http://www.w3.org/2000/svg">
        <title>icon</title>
        <g transform="rotate(-90 30.5 30.5)" fill="none" fill-rule="evenodd">
          <circle stroke="#ffffff" fill="#1D2A3A" transform="rotate(180 30.007 30.942)" cx="30.007" cy="30.942" r="30"></circle>
          <path fill="#ffffff" d="M25 38.884h3.713l6.3-7.797-6.3-8.087-3.713.064 6.155 7.972"></path>
        </g>
      </svg>
    </a>
  </div>
</footer>
<script src="https://cdnjs.cloudflare.com/ajax/libs/tocbot/4.1.1/tocbot.min.js"></script>
<script src="../../../_/js/site.js"></script>
<script src="../../../_/js/vendor/highlight.js"></script>
<script>hljs.initHighlighting()</script>
<script>
  tocbot.init( {
                 tocSelector: '#article-toc',
                 contentSelector: 'article',
                 headingSelector: 'h2, h3, h4',
                 collapseDepth: 3,
                 positionFixedSelector: '#article-toc',
                 scrollSmooth: false
               } );
  var tocList = document.getElementById( 'article-toc' ).getElementsByClassName( 'toc-list' );
  if ( tocList && tocList.length > 0 && tocList[0].childNodes.length > 0 ) {
    document.getElementById( 'article-toc' ).parentNode.classList.remove( 'hidden' );
  }
</script>
  </body>
</html>
